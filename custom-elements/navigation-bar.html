<template id="navigation-bar-template">
    <style>
        .back-zone {
            flex-grow: 1;
            width: 20%;
            display: flex;
            align-items: center;
            padding-left: 10px;
        }

        .back-zone img {
            width: 15px;
        }

        .back-zone span {
            flex-grow: 1;
        }

        .center-zone {
            flex-grow: 2;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .right-zone {
            flex-grow: 1;
            width: 20%;
        }

        :host {
            display: flex;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 40px;
            background: #fff;
            color: #555;
            box-sizing: border-box;
        } 
    </style>

    <div class="back-zone">
        <slot></slot>
        <span></span>
    </div>
    <div class="center-zone">
        <span></span>
    </div>
    <div class="right-zone">
        <slot></slot>
    </div>
</template>





<script>
    ( _ => {
 
        const navTemplate = document.currentScript.ownerDocument.querySelector('#navigation-bar-template')

        if (window.ShadyCSS)
                ShadyCSS.prepareTemplate(navTemplate,'scell-navigation-bar')

        class NavigationBar extends HTMLElement {

            constructor() {
                super()
                const shadowRoot = this.attachShadow({mode:'open'})
                shadowRoot.appendChild(navTemplate.content.cloneNode(true))
            }

            get leftSlotAssignedNode () {
                return this.shadowRoot.querySelectorAll('slot')[0].assignedNodes()[0]
            }

            get rightSlotAssignedNode () {
                const slots = this.shadowRoot.querySelectorAll('slot')[1].assignedNodes()[0]
            }

            connectedCallback() {
                if (window.ShadyCSS)
                    ShadyCSS.styleElement(this);

                this.$title = this.shadowRoot.querySelector('.center-zone > span')
                this.$title.innerText = this.getAttribute('title') || 'Title'

                this.$backTitle = this.shadowRoot.querySelector('.back-zone > span')
                this.$backTitle.innerText = this.getAttribute('back-title') || ''

                this.backZone = this.shadowRoot.querySelector('.back-zone')
                
                if (this.backZone && this.navigator && this.navigator.pop) {
                    this.backZone.onclick = event => {
                        this.navigator.pop()
                    }
                }
                
                if (this.getAttribute('anim-back-title')) {
                    this.$backTitle.style.transform = 'translateX(50px)'
                }

                this.backZone.onclick = event => {
                    this.dispatchEvent(new CustomEvent('back-click'))
                }
            } 

            render () {
                setTimeout( _ => {
                    this.$title.style.opacity = 1
                    this.$backTitle.style.opacity = 1

                    if (this.getAttribute('anim-back-title')) {
                        this.$backTitle.style.transform = 'translateX(0)'
                    }
                })
            }
        }

        customElements.define('scell-navigation-bar',NavigationBar)
    })()
</script>